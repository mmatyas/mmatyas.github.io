"use strict";class n{constructor(n){this.blob=n,this.view=new DataView(this.blob),this.offset=0,this.t=new TextDecoder}i(){return this.offset}size(){return this.blob.byteLength}seek(n){this.offset=n}o(n){const t=this.blob.slice(this.offset,this.offset+n);return this.offset+=n,t}u(){const n=this.view.getUint8(this.offset);return this.offset+=1,n}l(){const n=this.view.getUint32(this.offset,!0);return this.offset+=4,n}h(){const n=[];for(;;){const t=this.u();if(!t)break;n.push(t)}const t=new Uint8Array(n);return this.t.decode(t)}}class t{constructor(){this.j=[],this.size=0,this.A=new TextEncoder}m(n){this.j.push(n),this.size+=n.byteLength}_(n){this.m(new Uint8Array([n]).buffer)}N(n){this.m(new Uint8Array(n).buffer)}U(n){this.m(new Uint32Array([n]).buffer)}k(n){this.m(new Uint32Array(n).buffer)}J(n){const t=this.A.encode(n);this.m(t),this._(0)}O(){const n=new Uint8Array(this.size);let t=0;for(const r of this.j)n.set(new Uint8Array(r),t),t+=r.byteLength;return n.buffer}}async function r(n,t){const r=await n.text(),e=JSON.parse(r);if(!Array.isArray(e))throw new Error("The JSON file must be an array");if(e.length!==t)throw new Error(`Mismatch in the number of elements!\nThe original file has ${t} entries,\nthe JSON has ${e.length}.`);const s=new TextEncoder;return e.map((n=>function(n,t){const r=n.encode(t),e=new Uint8Array(r.byteLength+1);return e.set(r,0),e[r.byteLength]=0,e}(s,n)))}async function e(t){try{const r=await t.arrayBuffer(),e=new n(r),s=e.l(),i=Array.from({length:s},(n=>e.l())).map((n=>(e.seek(n),e.l(),e.h())));return JSON.stringify(i,null,4)}catch(n){alert("Error when reading affix file!\n"+n.message)}return null}async function s(e,s){try{const i=await e.arrayBuffer(),o=new n(i),a=o.l();if(0==a)return new ArrayBuffer(0);const c=await r(s,a),f=o.l(),u=new t;u.U(a);let l=f;for(const n of c)u.U(l),l+=4+n.byteLength;const h=4*(1+a);if(h<f){o.seek(h);const n=o.o(f-h);u.m(n)}for(const n of c)u.N([1,3,0,255]),u.m(n);return u.O()}catch(n){alert("Error when creating affix file!\n"+n.message)}return null}async function i(t){try{const r=await t.arrayBuffer(),e=new n(r),s=e.l(),i=Array.from({length:s},(n=>e.l())).map((n=>(e.seek(n),e.u(),e.h())));return JSON.stringify(i,null,4)}catch(n){alert("Error when reading affix file!\n"+n.message)}return null}async function o(e,s){try{const i=await e.arrayBuffer(),o=new n(i),a=o.l();if(0==a)return new ArrayBuffer(0);const c=await r(s,a),f=Array.from({length:a},(n=>o.l())),u=new t;u.U(a);let l=f[0];for(const n of c)u.U(l),l+=1+n.byteLength;const h=4*(1+a);if(h<f[0]){o.seek(h);const n=o.o(f[0]-h);u.m(n)}for(let n=0;n<a;n++){o.seek(f[n]);let t=o.u();u._(t),u.m(c[n])}return u.O()}catch(n){alert("Error when creating affix file!\n"+n.message)}return null}async function a(t){try{const r=await t.arrayBuffer(),e=new n(r),s=e.l(),i=Array.from({length:s},(n=>e.l())).map((n=>(e.seek(n),e.h())));return JSON.stringify(i,null,4)}catch(n){alert("Error when reading affix file!\n"+n.message)}return null}async function c(e,s){try{const i=await e.arrayBuffer(),o=new n(i),a=o.l();if(0==a)return new ArrayBuffer(0);const c=await r(s,a),f=o.l(),u=new t;u.U(a);let l=f;for(const n of c)u.U(l),l+=n.byteLength;const h=4*(1+a);if(h<f){o.seek(h);const n=o.o(f-h);u.m(n)}for(const n of c)u.m(n);return u.O()}catch(n){alert("Error when creating affix file!\n"+n.message)}return null}async function f(t){try{const r=await t.arrayBuffer(),e=new n(r),s=e.l();e.seek(1350088);const i=Array.from({length:s},(n=>e.h()));return JSON.stringify(i,null,4)}catch(n){alert("Error when reading affix file!\n"+n.message)}return null}async function u(e,s){try{const i=await e.arrayBuffer(),o=new n(i),a=o.l();if(0==a)return new ArrayBuffer(0);const c=new t;o.seek(0);const f=o.o(1350088);c.m(f);const u=await r(s,a);for(const n of u)c.m(n);return c.O()}catch(n){alert("Error when creating affix file!\n"+n.message)}return null}function l(n,t,r){const e=document.createElement("a"),s=new Blob([t],{type:r});e.href=window.URL.createObjectURL(s),e.download=n,e.click()}function h(n,t,r){const e=document.getElementById(n);document.getElementById(t).onclick=async()=>{if(!e.files||!e.files.length)return;const n=e.files[0].name+".json",t=await r(e.files[0]);n&&t&&l(n,t,"application/json")}}function w(n,t,r,e){const s=document.getElementById(n),i=document.getElementById(t);document.getElementById(r).onclick=async()=>{if(!s.files||!s.files.length)return;if(!i.files||!i.files.length)return;const n=await e(s.files[0],i.files[0]);n&&l("NEW_"+s.files[0].name,n,"application/octet-stream")}}window.onload=()=>{h("affix2json-in","affix2json-btn",e),w("json2affix-orig","json2affix-json","json2affix-btn",s),h("base2json-in","base2json-btn",i),w("json2base-orig","json2base-json","json2base-btn",o),h("default2json-in","default2json-btn",a),w("json2default-orig","json2default-json","json2default-btn",c),h("keys2json-in","keys2json-btn",f),w("json2keys-orig","json2keys-json","json2keys-btn",u)};
